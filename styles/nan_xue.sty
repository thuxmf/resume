% Copyright (C) by Mengfei Xia <xiamengfei0409@gmail.com>
% 07/17/2024 v1.1

\ProvidesClass{styles/mengfei_xia}
[07/17/2024 v1.1 Resume Template File @ Mengfei Xia]
\NeedsTeXFormat{LaTeX2e}
\@ifl@t@r\fmtversion{2017/04/15}{}{
  \xia@error{%
    TeX Live 2017 or later version is required to compile this document%
  }
}
% Customize the packages.
\RequirePackage{geometry}
\RequirePackage{bookmark}
\RequirePackage[sc,osf]{mathpazo}
\RequirePackage{sectsty}
\RequirePackage[square,sort,comma,numbers]{natbib}
\RequirePackage{setspace}
\RequirePackage{url}
\RequirePackage{xcolor}
\RequirePackage{fancyhdr}
% \makeatletter\let\saved@bibitem\@bibitem\makeatother
\RequirePackage{hyperref}
% \makeatletter\let\@bibitem\saved@bibitem\makeatother
\RequirePackage{threeparttable}
\RequirePackage{tabularray}

% Page setups.
\pagestyle{fancy}
\fancyhf{}  % clear all header and footer fields
\fancyfoot{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\markright{\xia@name}
\thispagestyle{empty}
\geometry{
  paper          = a4paper,  % 210 * 297mm
  top            = 0.65in,
  left           = 1.0in,
  right          = 1.0in,
  bottom         = 0.5in,
  marginparwidth = 1.5cm,
  marginparsep   = 0.5cm,
}
\hypersetup{%
  colorlinks     = {false},
  urlcolor       = {black},
  pdfauthor      = {\xia@name},
  pdftitle       = {\xia@name},
}
\sectionfont{\rmfamily\mdseries\Large}
\subsectionfont{\rmfamily\mdseries\itshape\large}
\setlength\parindent{0em}

% Define colors.
\definecolor{section-color}{RGB}{150,0,0}
\def\xia@title@color{section-color}

% Define names.
\newcommand\xia@set@names{%
  \ifxia@language@english
    \def\xia@resume@education{Education Experiences}
    \def\xia@resume@publication{Selected Publications}
    \def\xia@resume@experience{Working Experiences}
    \def\xia@resume@phone{Phone}
    \def\xia@resume@email{Email}
    \def\xia@resume@homepage{Homepage}
    \def\xia@resume@googlescholar{Google Scholar}
    \def\xia@resume@linkedin{LinkedIn}
    \def\xia@resume@activity{Professional Activities}
    \def\xia@resume@honor{Honors and Awards}
    \def\xia@resume@skill{Skills and Others}
    \def\xia@resume@lastupdate{\hfill\footnotesize\color{gray} Last updated on \today}
  \else
    \def\xia@resume@education{教育经历}
    \def\xia@resume@publication{代表性论文}
    \def\xia@resume@experience{工作经历}
    \def\xia@resume@phone{电话}
    \def\xia@resume@email{邮箱}
    \def\xia@resume@homepage{主页}
    \def\xia@resume@googlescholar{谷歌学术}
    \def\xia@resume@linkedin{领英}
    \def\xia@resume@activity{学术活动}
    \def\xia@resume@honor{获奖情况}
    \def\xia@resume@skill{其他技能}
    \def\xia@resume@lastupdate{\hfill\footnotesize\color{gray} 更新于 \today}
  \fi
}
\xia@set@names
\xia@option@hook{language}{\xia@set@names}

% Define info style.
\newcommand{\info}{%
\ifxia@language@english
  \ifx\xia@company\xia@none
    {\huge \xia@name} 
  \else
    {\huge \xia@name}
  \fi
\else
  \ifx\xia@company@zh\xia@none
    {\huge \xia@name@zh}
  \else
    {\huge \xia@name@zh}
  \fi
\fi
\par
\vspace{0.25in}
% \renewcommand\arraystretch{0.8}
% \setlength{\tabcolsep}{10.0pt}
\noindent 
\begin{tabular}{ll}
  \xia@resume@phone : & \xia@phone \\
  \xia@resume@email : & \href{mailto:\xia@email}{\tt \xia@email} \\
  \ifx\xia@homepage\xia@none
  \else
    \xia@resume@homepage : & \href{\xia@homepage}{\tt \xia@homepage} \\
  \fi
  \ifx\xia@googlescholar\xia@none
  \else
    % \xia@resume@googlescholar : & \href{\xia@googlescholar}{\tt \xia@googlescholar} \\
    \xia@resume@googlescholar : & \xia@googlescholar \\
  \fi
  \ifx\xia@linkedin\xia@none
  \else
    \xia@resume@linkedin : & \href{\xia@linkedin}{\tt \xia@linkedin} \\
  \fi
\end{tabular}

\rule{\textwidth}{1.0pt}
\vspace{0.0\baselineskip}
}

% Define environments.
\newenvironment{education}{
  \section*{\color{\xia@title@color}\xia@resume@education}
  % \vspace{-0.6\baselineskip}
  \par
}{%
  \par
  \rule{\textwidth}{0.5pt}
  \vspace{-0.5\baselineskip}
}
\newenvironment{publication}{
  \section*{\color{\xia@title@color}\xia@resume@publication}
  % \par
  \vspace{-0.6\baselineskip}
  \ifxia@language@english
    $^*$ equal contribution\quad$^\dag$ corresponding author
  \else
    $^*$ 共一\quad$^\dag$ 通讯作者
  \fi
  \par
  \vspace{-0.3\baselineskip}
}{%
\par
\rule{\textwidth}{0.5pt}
\vspace{-0.5\baselineskip}
}
\newenvironment{experience}{
  \section*{\color{\xia@title@color}\xia@resume@experience}
  \vspace{-0.6\baselineskip}
  \par
}{%
\par
\rule{\textwidth}{0.5pt}
\vspace{-0.5\baselineskip}
}
\newenvironment{activity}{
  \section*{\color{\xia@title@color}\xia@resume@activity}
  \vspace{-0.6\baselineskip}
  \par
}{%
\par
\rule{\textwidth}{0.5pt}
\vspace{-0.5\baselineskip}
}
\newenvironment{honor}{
  \section*{\color{\xia@title@color}\xia@resume@honor}
  \vspace{-0.6\baselineskip}
  \par
}{%
\par
\rule{\textwidth}{0.5pt}
\vspace{-0.5\baselineskip}
}
\newenvironment{skill}{
  \section*{\color{\xia@title@color}\xia@resume@skill}
  \vspace{-0.6\baselineskip}
  \par
  \begin{tabular}{@{}l@{\extracolsep{\fill}}r@{}}
}{%
  \end{tabular}
  \par
  % \rule{\textwidth}{0.5pt}
  % \vspace{-0.5\baselineskip}
}

% Customized itemize.
\newenvironment{customitemize}{
  \begin{list}{}{
    \setlength{\leftmargin}{.5em}
  }
}{
  \end{list}
}

% Render education.
\newcommand\rendereducation{
  \ifxia@language@english
    \def\xia@edu@spacing{0.95}
  \else
    \def\xia@edu@spacing{1.05}
  \fi
  \begin{spacing}{\xia@edu@spacing}
  \ifxia@language@english
    \ifx\xia@edu@school\xia@none
    \else
    \begin{customitemize}
      \item \textbf{\xia@edu@school \hfill{\xia@edu@location}}
      \par
      \emph{\xia@edu@intro\hfill{\xia@edu@time}}
      \par
      \ifx\xia@edu@detail@zh\xia@none
      \else
        {\small\textcolor{gray}{\xia@edu@detail}}
        \par
      \fi
    \end{customitemize}
    \fi
  \else
    \ifx\xia@edu@school@zh\xia@none
    \else
    \begin{customitemize}
      \item \textbf{\xia@edu@school@zh \hfill{\xia@edu@location@zh}}
      \par
      \emph{\xia@edu@intro@zh\hfill{\xia@edu@time@zh}}
      \par
      \ifx\xia@edu@detail@zh\xia@none
      \else
        {\small\textcolor{gray}{\xia@edu@detail@zh}}
        \par
      \fi
    \end{customitemize}
    \fi
  \fi
  \end{spacing}
  \vspace{-0.1in}
  \xia@empty@education
}

% Render publications.
\newcommand\xia@contrib[1]{
  \ifx#1\xia@none
    \hskip -5pt
  \else
    \ifx#1\equal
      \hskip -2pt$^*$\hskip -3pt
    \else
      \hskip -2pt$^\dag$\hskip -3pt
    \fi
  \fi
}
\newcommand\xia@status[1]{
  \ifx#1\xia@none
  \else
    \ifx#1\under
      (under review)
    \fi
    \ifx#1\oral
      oral
    \fi
    \ifx#1\spotlight
      spotlight
    \fi
  \fi
}
\newcommand\xia@render@pub@firstauthor[2]{
  \ifx#1\xia@none
  \else
    \ifx#1\xia@name
      \hskip -4pt\textbf{\textcolor{black}{#1}\xia@contrib{#2}}
    \else
      \hskip -4pt\textcolor{gray}{#1\xia@contrib{#2}}
    \fi
  \fi
}
\newcommand\xia@render@pub@author[2]{
  \ifx#1\xia@none
  \else
    \ifx#1\xia@name
      \hskip -4pt\textbf{\textcolor{gray}{, }\textcolor{black}{#1}\xia@contrib{#2}}
    \else
      \hskip -4pt\textcolor{gray}{, #1\xia@contrib{#2}}
    \fi
  \fi
}
\newcommand\renderpublication{
  \ifx\xia@pub@title\xia@none
  \else
  \begin{customitemize}
    \item {\small\textbf{\xia@pub@title}\hfill{\textbf{\xia@pub@location}\xia@status{\xia@pub@status}}}
    \vspace{-0.04in}
    \par
    \footnotesize\emph{
      \xia@render@pub@firstauthor{\xia@pub@author@a}{\xia@pub@contrib@a}
      \xia@render@pub@author{\xia@pub@author@b}{\xia@pub@contrib@b}
      \xia@render@pub@author{\xia@pub@author@c}{\xia@pub@contrib@c}
      \xia@render@pub@author{\xia@pub@author@d}{\xia@pub@contrib@d}
      \xia@render@pub@author{\xia@pub@author@e}{\xia@pub@contrib@e}
      \xia@render@pub@author{\xia@pub@author@f}{\xia@pub@contrib@f}
      \xia@render@pub@author{\xia@pub@author@g}{\xia@pub@contrib@g}
      \xia@render@pub@author{\xia@pub@author@h}{\xia@pub@contrib@h}
      \xia@render@pub@author{\xia@pub@author@i}{\xia@pub@contrib@i}
      \xia@render@pub@author{\xia@pub@author@j}{\xia@pub@contrib@j}
    }
  \end{customitemize}
  \vspace{-0.25in}
  \xia@empty@publication
  \fi
}

% Render experiences.
\newcommand\renderexperience{
  \ifx\xia@exp@time@zh\xia@none
    \let\xia@exp@time@zh\xia@exp@time
  \fi
  \ifxia@language@english
    \ifx\xia@exp\xia@none
    \else
    \begin{customitemize}
      \item \textbf{\xia@exp}\hfill{\emph{\xia@exp@time}}
      \par
      \vspace{-0.08in}
      {\small\xia@exp@type\hfill\xia@exp@location}
      \par
      \ifx\xia@exp@intro\xia@none
      \else
        \vspace{-0.08in}
        {\small\textcolor{gray}{\xia@exp@intro}}
        \par
      \fi
    \end{customitemize}
    \fi
  \else
    \ifx\xia@exp@zh\xia@none
    \else
    \begin{customitemize}
      \item \textbf{\xia@exp@zh}\hfill{\emph{\xia@exp@time@zh}}
      \par
      \vspace{-0.08in}
      {\small\xia@exp@type@zh\hfill\xia@exp@location@zh}
      \par
      \ifx\xia@exp@intro@zh\xia@none
      \else
        \vspace{-0.08in}
        {\small\textcolor{gray}{\xia@exp@intro@zh}}
        \par
      \fi
    \end{customitemize}
    \fi
  \fi
  \xia@empty@experience
  \vspace{-0.20in}
}

% Render activities.
\newcommand\renderactivity{
  \ifxia@language@english
    \ifx\xia@act\xia@none
    \else
      \begin{customitemize}
        \item \textbf{\xia@act :} \xia@act@explanation
      \end{customitemize}
    \fi
  \else
    \ifx\xia@act@zh\xia@none
    \else
      \begin{customitemize}
        \item \textbf{\xia@act@zh：}\xia@act@explanation@zh
      \end{customitemize}
    \fi
  \fi
  \xia@empty@activity
  \vspace{-0.2in}
}

% Render honors.
\newcommand\renderhonor{
  \ifxia@language@english
    \ifx\xia@honor\xia@none
    \else
      \begin{customitemize}
        \item \textbf{\xia@honor}, \xia@honor@affiliation, \xia@honor@time
      \end{customitemize}
    \fi
  \else
    \ifx\xia@honor@zh\xia@none
    \else
      \begin{customitemize}
        \item \textbf{\xia@honor@zh}，\xia@honor@affiliation@zh，\xia@honor@time@zh
      \end{customitemize}
    \fi
  \fi
  \xia@empty@honor
  \vspace{-0.2in}
}

% Render skills.
\newcommand\tabitem{\textbullet~~}
\newcommand\renderskill[1]{
  \ifxia@language@english
    \ifthenelse{\equal{#1}{\le}}{%
      \tabitem \begin{minipage}[b]{0.5\linewidth}\textbf{\xia@skill :} \xia@skill@intro\end{minipage} &
    }{%
      \hfill \tabitem \begin{minipage}[b]{0.5\linewidth}\textbf{\xia@skill :} \xia@skill@intro\end{minipage} \\
    }
  \else
    \ifthenelse{\equal{#1}{\le}}{%
      \tabitem \begin{minipage}[b]{0.5\linewidth}\textbf{\xia@skill@zh：} \xia@skill@intro@zh\end{minipage} &
    }{%
      \hfill \tabitem \begin{minipage}[b]{0.5\linewidth}\textbf{\xia@skill@zh：} \xia@skill@intro@zh\end{minipage} \\
    }
  \fi
}
